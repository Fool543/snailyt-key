<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Support Developers with VIP</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: radial-gradient(circle at top, rgba(0,255,255,0.08), transparent 45%),
                  radial-gradient(circle at bottom, rgba(255,0,255,0.08), transparent 45%),
                  #0f0f0f;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: #fff;
      padding: 20px;
    }

    .container {
      position: relative;
      background-color: rgba(24, 24, 24, 0.88);
      backdrop-filter: blur(14px);
      border-radius: 24px;
      padding: 42px 40px;
      text-align: center;
      max-width: 640px;
      box-shadow: 0 16px 45px rgba(0, 0, 0, 0.7);
      animation: fadeIn 1s ease-in-out;
      border: 1px solid rgba(255, 255, 255, 0.06);
      overflow: hidden;
    }

    /* Premium glowing border layer */
    .container::before {
      content: "";
      position: absolute;
      inset: -2px;
      border-radius: 26px;
      padding: 2px;
      background: linear-gradient(135deg,
        rgba(0,255,255,0.55),
        rgba(255,0,255,0.55),
        rgba(0,255,255,0.55)
      );
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
              mask-composite: exclude;
      opacity: 0.35;
      pointer-events: none;
      filter: blur(0.2px);
    }

    /* Floating glow blobs */
    .glow-orb {
      position: absolute;
      width: 260px;
      height: 260px;
      border-radius: 999px;
      filter: blur(45px);
      opacity: 0.18;
      z-index: 0;
      pointer-events: none;
    }

    .glow-orb.one {
      background: #00ffff;
      top: -120px;
      left: -120px;
    }

    .glow-orb.two {
      background: #ff00ff;
      bottom: -140px;
      right: -140px;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .content {
      position: relative;
      z-index: 1;
    }

    h1 {
      color: #fff;
      margin-bottom: 12px;
      font-size: 2.05rem;
      font-weight: 800;
      letter-spacing: 0.3px;
    }

    .subtitle {
      color: rgba(255, 255, 255, 0.82);
      margin-bottom: 18px;
      font-size: 1.02rem;
      line-height: 1.65;
    }

    h2 {
      color: #00ffd0;
      margin-top: 18px;
      margin-bottom: 12px;
      font-size: 1.45rem;
      font-weight: 800;
    }

    .vip-card {
      margin-top: 14px;
      border-radius: 20px;
      padding: 18px 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border: 1px solid rgba(0, 255, 255, 0.18);
      box-shadow: 0 12px 34px rgba(0,0,0,0.55);
      text-align: left;
    }

    .vip-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
    }

    .vip-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(0, 255, 255, 0.08);
      border: 1px solid rgba(0, 255, 255, 0.22);
      color: #bffcff;
      font-weight: 700;
      font-size: 0.92rem;
      letter-spacing: 0.2px;
    }

    .vip-price {
      display: inline-flex;
      align-items: baseline;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255, 0, 255, 0.08);
      border: 1px solid rgba(255, 0, 255, 0.20);
      font-weight: 800;
      color: #ffd7ff;
      white-space: nowrap;
    }

    .vip-price small {
      font-weight: 600;
      color: rgba(255, 255, 255, 0.72);
    }

    .vip-list {
      margin-top: 12px;
      display: grid;
      gap: 10px;
    }

    .vip-item {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0, 0, 0, 0.22);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .tick {
      width: 22px;
      height: 22px;
      border-radius: 7px;
      display: grid;
      place-items: center;
      background: rgba(0, 255, 255, 0.12);
      border: 1px solid rgba(0, 255, 255, 0.20);
      flex: 0 0 22px;
      margin-top: 1px;
      box-shadow: 0 0 14px rgba(0, 255, 255, 0.10);
    }

    .vip-item b {
      font-weight: 800;
      color: #fff;
    }

    .vip-item span {
      color: rgba(255, 255, 255, 0.80);
      font-size: 0.95rem;
      line-height: 1.5;
      display: block;
    }

    .vip-note {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px dashed rgba(255, 255, 255, 0.18);
      color: rgba(255, 255, 255, 0.78);
      font-size: 0.92rem;
      line-height: 1.45;
    }

    .vip-note b {
      color: #ffffff;
    }

    .buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 24px;
    }

    .buttons a {
      background-color: #222;
      color: #ffffff;
      text-decoration: none;
      padding: 14px 20px;
      border-radius: 50px;
      font-size: 15px;
      font-weight: 700;
      transition: all 0.3s ease;
      border: 1px solid #444;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      text-align: center;
    }

    .buttons a:hover {
      background-color: #333;
      color: #00ffff;
      transform: translateY(-2px);
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.2);
    }

    /* üåü VIP Button Neon Premium */
    .vip-btn {
      background: linear-gradient(135deg, #ff00ff, #00ffff, #ff00ff);
      background-size: 300% 300%;
      animation: neonShift 5s ease infinite;
      color: #ffffff !important;
      border: 2px solid rgba(0, 255, 255, 0.9);
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.8), 0 0 20px rgba(255, 0, 255, 0.6);
      font-size: 17px;
      font-weight: 800;
      letter-spacing: 0.6px;
      box-shadow: 0 10px 28px rgba(0,0,0,0.6);
    }

    .vip-btn::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.18), transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .vip-btn:hover {
      transform: scale(1.05) translateY(-2px);
      box-shadow: 0 0 26px rgba(255, 0, 255, 0.55), 0 0 44px rgba(0, 255, 255, 0.35);
      color: #ffffff !important;
    }

    @keyframes neonShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ‚úÖ Overlays */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }

    .box {
      width: 100%;
      max-width: 420px;
      background: rgba(24, 24, 24, 0.92);
      border: 1px solid rgba(0, 255, 255, 0.25);
      border-radius: 22px;
      padding:  28px 24px;
      text-align: center;
      box-shadow: 0 10px 35px rgba(0, 0, 0, 0.7);
      animation: fadeIn 0.4s ease-in-out;
    }

    .title {
      font-size: 1.2rem;
      font-weight: 800;
      margin-bottom: 10px;
      color: #00ffd0;
    }

    .sub {
      font-size: 0.95rem;
      color: rgba(255, 255, 255, 0.85);
      margin-bottom: 18px;
      line-height: 1.5;
    }

    .countdown {
      font-size: 2.2rem;
      font-weight: 900;
      letter-spacing: 1px;
      margin-bottom: 18px;
      text-shadow: 0 0 14px rgba(0, 255, 255, 0.25);
    }

    .progress-wrap {
      width: 100%;
      height: 14px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.08);
      overflow: hidden;
      margin-bottom: 14px;
    }

    .progress-bar {
      width: 0%;
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, #00ffff, #ff00ff, #00ffff);
      background-size: 200% 200%;
      animation: progressGlow 2.5s ease infinite;
      transition: width 0.2s linear;
    }

    @keyframes progressGlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .small-note {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.7);
    }

    body.locked {
      overflow: hidden;
    }

    /* Hold button */
    .hold-btn {
      display: inline-block;
      margin-top: 12px;
      background: #222;
      color: #fff;
      text-decoration: none;
      padding: 14px 20px;
      border-radius: 50px;
      border: 1px solid #444;
      font-weight: 800;
      transition: all 0.2s ease;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
      cursor: pointer;
    }

    .hold-btn:hover {
      background: #333;
      color: #00ffff;
      transform: translateY(-1px);
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.2);
    }

    /* ‚úÖ VIP Contact Cards inside overlay */
    .vip-grid {
      display: grid;
      gap: 12px;
      margin-top: 14px;
      text-align: left;
    }

    .vip-contact-card {
      background: rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 16px;
      padding: 14px 14px;
    }

    .vip-user {
      font-weight: 900;
      font-size: 1.05rem;
      color: #fff;
      margin-bottom: 4px;
    }

    .vip-role {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.75);
      margin-bottom: 12px;
      line-height: 1.35;
    }

    .copy-btn {
      width: 100%;
      background: linear-gradient(135deg, rgba(0,255,255,0.18), rgba(255,0,255,0.18));
      border: 1px solid rgba(0, 255, 255, 0.35);
      color: #ffffff;
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.25s ease;
      text-align: center;
    }

    .copy-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 16px rgba(0, 255, 255, 0.18);
      border-color: rgba(255, 0, 255, 0.35);
    }

    .close-btn {
      margin-top: 12px;
      width: 100%;
      background: #222;
      border: 1px solid #444;
      color: #fff;
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .close-btn:hover {
      background: #333;
      color: #00ffff;
      transform: translateY(-1px);
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.15);
    }

    /* ‚úÖ Toast (instead of alert) */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(24,24,24,0.92);
      border: 1px solid rgba(0,255,255,0.25);
      color: rgba(255,255,255,0.92);
      padding: 12px 14px;
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.55);
      display: none;
      z-index: 10000;
      max-width: 520px;
      width: calc(100% - 40px);
      text-align: center;
      font-weight: 700;
    }

    @media (max-width: 480px) {
      .container { padding: 28px 22px; }
      .buttons a { font-size: 14px; padding: 12px; }
      .countdown { font-size: 2rem; }
      h1 { font-size: 1.8rem; }
    }

#vipOverlay .box{
  max-width: 520px;
  border-radius: 26px;
  padding: 26px 22px;
  background: rgba(18, 18, 18, 0.72);
  border: 1px solid rgba(0, 255, 255, 0.22);
  box-shadow:
    0 18px 60px rgba(0,0,0,0.75),
    0 0 0 1px rgba(255,255,255,0.03) inset;
  position: relative;
  overflow: hidden;
  transform: translateY(6px) scale(0.98);
  animation: vipPop 0.35s ease forwards;
}

@keyframes vipPop {
  to { transform: translateY(0) scale(1); }
}

/* gradient glow ring */
#vipOverlay .box::before{
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: 28px;
  background: linear-gradient(135deg,
    rgba(0,255,255,0.55),
    rgba(255,0,255,0.45),
    rgba(0,255,255,0.45)
  );
  opacity: 0.22;
  pointer-events: none;
  filter: blur(0.4px);
}

/* inner dark layer to keep content readable */
#vipOverlay .box::after{
  content: "";
  position: absolute;
  inset: 1px;
  border-radius: 25px;
  background: rgba(18,18,18,0.88);
  pointer-events: none;
}

#vipOverlay .vip-modal-content{
  position: relative;
  z-index: 1;
}

/* Title row */
.vip-title-row{
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin-bottom: 6px;
}

.vip-crown{
  width: 38px;
  height: 38px;
  border-radius: 12px;
  display: grid;
  place-items: center;
  background: rgba(0,255,255,0.10);
  border: 1px solid rgba(0,255,255,0.25);
  box-shadow: 0 0 18px rgba(0,255,255,0.12);
  font-size: 18px;
}

#vipOverlay .title{
  margin: 0;
  font-size: 1.25rem;
  font-weight: 900;
  color: #00ffd0;
  letter-spacing: 0.2px;
}

/* Subtitle */
#vipOverlay .sub{
  margin-top: 8px;
  margin-bottom: 18px;
  color: rgba(255,255,255,0.82);
  font-size: 0.96rem;
  line-height: 1.55;
}

.vip-hint{
  margin-top: 10px;
  padding: 12px 12px;
  border-radius: 16px;
  background: rgba(255,255,255,0.03);
  border: 1px dashed rgba(255,255,255,0.16);
  color: rgba(255,255,255,0.78);
  font-weight: 600;
}

/* Contact list */
.vip-grid{
  display: grid;
  gap: 14px;
  margin-top: 16px;
}

.vip-contact-card{
  border-radius: 18px;
  padding: 14px 14px;
  background: rgba(0,0,0,0.28);
  border: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 10px 26px rgba(0,0,0,0.35);
}

.vip-card-top{
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
}

.vip-avatar{
  width: 46px;
  height: 46px;
  border-radius: 16px;
  display: grid;
  place-items: center;
  background: linear-gradient(135deg, rgba(0,255,255,0.18), rgba(255,0,255,0.14));
  border: 1px solid rgba(0,255,255,0.22);
  box-shadow: 0 0 22px rgba(0,255,255,0.10);
  font-weight: 900;
  font-size: 16px;
  color: #fff;
}

.vip-user{
  margin: 0;
  font-weight: 900;
  font-size: 1.05rem;
  color: rgba(255,255,255,0.95);
}

.vip-role{
  margin-top: 2px;
  font-size: 0.9rem;
  color: rgba(255,255,255,0.70);
  line-height: 1.35;
}

/* Copy Button Premium */
.copy-btn{
  width: 100%;
  border-radius: 16px;
  padding: 12px 14px;
  font-weight: 900;
  font-size: 0.95rem;
  letter-spacing: 0.2px;
  border: 1px solid rgba(0,255,255,0.30);
  background: linear-gradient(135deg, rgba(0,255,255,0.20), rgba(255,0,255,0.18));
  color: rgba(255,255,255,0.95);
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.25s ease, border-color 0.25s ease;
  position: relative;
  overflow: hidden;
}

.copy-btn::after{
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.20), transparent 55%);
  opacity: 0.85;
  pointer-events: none;
}

.copy-btn:hover{
  transform: translateY(-1px);
  box-shadow: 0 0 22px rgba(0,255,255,0.18), 0 14px 34px rgba(0,0,0,0.45);
  border-color: rgba(255,0,255,0.30);
}

.copy-btn:active{
  transform: translateY(0);
}

/* Close button upgraded */
.close-btn{
  margin-top: 14px;
  width: 100%;
  border-radius: 16px;
  padding: 12px 14px;
  font-weight: 900;
  font-size: 0.95rem;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.04);
  color: rgba(255,255,255,0.90);
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.25s ease, background 0.25s ease;
}

.close-btn:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,0.06);
  box-shadow: 0 0 16px rgba(255,255,255,0.06);
}

/* Mobile tuning */
@media (max-width: 480px){
  #vipOverlay .box{
    padding: 22px 16px;
  }
  .vip-avatar{
    width: 42px;
    height: 42px;
    border-radius: 14px;
  }
}
  </style>
</head>

<body>
  <div class="container">
    <div class="glow-orb one"></div>
    <div class="glow-orb two"></div>

    <div class="content">
      <!-- ‚úÖ KEEP THIS PART SAME (AS YOU REQUESTED) -->
      <h1>üíé Support Developers with VIP</h1>
      <p class="subtitle">
        We work hard to bring you the best tools and updates. The VIP plan helps fund development,
        improvements, and new features.
      </p>

      <h2>‚ú® VIP Plan Benefits</h2>

      <div class="vip-card">
        <div class="vip-header">
          <div class="vip-badge">üëë VIP ACCESS</div>
          <div class="vip-price">‚Çπ240 <small>fixed price</small></div>
        </div>

        <div class="vip-list">
          <div class="vip-item">
            <div class="tick">‚úÖ</div>
            <span><b>No Verification</b><br />Instant access without countdown checks.</span>
          </div>

          <div class="vip-item">
            <div class="tick">‚úÖ</div>
            <span><b>120 FPS Unlocked</b><br />Up to Ultra HD in-game for smoother gameplay.</span>
          </div>

          <div class="vip-item">
            <div class="tick">‚úÖ</div>
            <span><b>Resolution Support: 480p to 4K</b><br />
              <b>480p</b> helps you get <b>maximum FPS</b> on <b>low-end PCs</b>.<br />
              <b>4K</b> is for the <b>best graphics texture quality</b> and an experience like never before.
            </span>
          </div>
        </div>

        <div class="vip-note">
          ‚úÖ <b>Non-refundable</b><br />
          ‚úÖ <b>Price is fixed (non-negotiable)</b>
        </div>
      </div>

      <!-- ‚úÖ BUTTONS (YouTube/Telegram removed) -->
      <div class="buttons">
        <a href="#" class="vip-btn" onclick="openVipOverlay(event)">
          ‚ú® Buy VIP Plan (‚Çπ240) Now ‚ú®
        </a>

        <a href="#" onclick="startSupportFlow(event)">üí∞ Continue with Verification</a>
      </div>
    </div>
  </div>

  <!-- ‚úÖ VIP CONTACT OVERLAY -->
  <div class="overlay" id="vipOverlay">
    <div class="box">
      <div class="vip-modal-content">
        <div class="vip-title-row">
          <div class="vip-crown">üëë</div>
          <div class="title">VIP Subscription Support</div>
        </div>

        <div class="sub">
          DM <b>any one</b> of the Telegram contacts below and ask for <b>VIP Subscription</b>.
          They will guide you further.
          <div class="vip-hint">
            Copy the link below and paste it in your browser for easier access.
          </div>
        </div>

        <div class="vip-grid">
          <!-- Contact 1 -->
          <div class="vip-contact-card">
            <div class="vip-card-top">
              <div class="vip-avatar">S</div>
              <div>
                <div class="vip-user">@ssmpmaddy</div>
                <div class="vip-role">Official VIP Subscription Support</div>
              </div>
            </div>
            <button class="copy-btn" onclick="copyText('https://t.me/ssmpmaddy')">Copy Link</button>
          </div>

          <!-- Contact 2 -->
          <div class="vip-contact-card">
            <div class="vip-card-top">
              <div class="vip-avatar">I</div>
              <div>
                <div class="vip-user">@infinish_10</div>
                <div class="vip-role">Official VIP Subscription Support</div>
              </div>
            </div>
            <button class="copy-btn" onclick="copyText('https://t.me/infinish_10')">Copy Link</button>
          </div>
        </div>

        <button class="close-btn" onclick="closeVipOverlay()">Close</button>
      </div>
    </div>
  </div>

  <!-- ‚úÖ Countdown Overlay -->
  <div class="overlay" id="timerOverlay">
    <div class="box">
      <div class="title">‚è≥ Please Wait...</div>
      <div class="sub">
        Preparing your verification link.<br />
        You will be redirected automatically.
      </div>

      <div class="countdown" id="countdownText">90s</div>

      <div class="progress-wrap">
        <div class="progress-bar" id="progressBar"></div>
      </div>

      <div class="small-note">Do not close this page during the countdown.</div>
    </div>
  </div>

  <!-- ‚úÖ Random Hold Check Overlay -->
  <div class="overlay" id="holdOverlay">
    <div class="box">
      <div class="title">‚úÖ Continue Check</div>
      <div class="sub" id="holdMessage">Hold the button for <b>3 seconds</b> to continue.</div>

      <div class="progress-wrap" style="margin-top: 10px;">
        <div class="progress-bar" id="holdBar" style="width:0%;"></div>
      </div>

      <div class="hold-btn" id="holdBtn">Press & Hold (3s)</div>

      <div class="small-note" style="margin-top:14px;">
        Countdown is paused until you complete this step.
      </div>
    </div>
  </div>

  <!-- ‚úÖ Toast -->
  <div class="toast" id="toast"></div>

  <script>
    const SUPPORT_LINK = "https://fool543.github.io/snailyt-key/snailx/thank/thanks-GP.html";

    // ‚úÖ EDIT #3: close VIP overlay when clicking outside the modal
    document.getElementById("vipOverlay").addEventListener("click", (e) => {
      if (e.target.id === "vipOverlay") closeVipOverlay();
    });

    function openVipOverlay(e) {
      e.preventDefault();
      document.getElementById("vipOverlay").style.display = "flex";
      document.body.classList.add("locked");

      // ‚úÖ EDIT #2: Safe confetti guard (won't error if CDN blocked)
      if (typeof confetti === "function") {
        confetti({
          particleCount: 120,
          spread: 90,
          origin: { y: 0.65 },
          colors: ['#00ffff', '#ff00ff', '#ffffff']
        });
      }
    }

    function closeVipOverlay() {
      document.getElementById("vipOverlay").style.display = "none";
      document.body.classList.remove("locked");
    }

    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.textContent = message;
      toast.style.display = "block";

      clearTimeout(window.__toastTimer);
      window.__toastTimer = setTimeout(() => {
        toast.style.display = "none";
      }, 2200);
    }

    function copyText(text) {
      navigator.clipboard.writeText(text).then(() => {
        showToast("Copied link: " + text);
      }).catch(() => {
        showToast("Copy failed. Please copy manually: " + text);
      });
    }

    // --- Countdown State ---
    // ‚úÖ EDIT #1: countdown matches UI (90 seconds)
    let totalSeconds = 90;
    let remaining = 90;
    let timerInterval = null;

    // --- Random Checks State ---
    let checkpoints = [];
    let nextCheckpointIndex = 0;

    function startSupportFlow(e) {
      e.preventDefault();

      remaining = totalSeconds;
      nextCheckpointIndex = 0;

      // ‚úÖ Minimum 4 checks
      // ‚úÖ Maximum random up to 8 checks
      const minChecks = 4;
      const maxChecks = 8;
      const checksPlanned = randInt(minChecks, maxChecks);

      // Place checks randomly between remaining 8..55 seconds
      checkpoints = generateSpacedRandomCheckpoints(checksPlanned, 8, 55);

      // Sort: higher remaining triggers earlier
      checkpoints.sort((a, b) => b - a);

      document.getElementById("timerOverlay").style.display = "flex";
      document.body.classList.add("locked");

      updateTimerUI();
      startCountdown();
    }

    function randInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // ‚úÖ Random intervals but avoids too many checks too close together
    function generateSpacedRandomCheckpoints(count, minRemaining, maxRemaining) {
      const picks = [];
      const minGap = 5; // minimum gap in seconds between checks

      let attempts = 0;
      while (picks.length < count && attempts < 1000) {
        attempts++;
        const value = randInt(minRemaining, maxRemaining);

        const ok = picks.every(v => Math.abs(v - value) >= minGap);
        if (ok) picks.push(value);
      }

      // Fallback if spacing couldn't fill enough
      while (picks.length < count) {
        picks.push(randInt(minRemaining, maxRemaining));
      }

      return picks;
    }

    function updateTimerUI() {
      const countdownText = document.getElementById("countdownText");
      const progressBar = document.getElementById("progressBar");

      countdownText.textContent = remaining + "s";
      const progress = ((totalSeconds - remaining) / totalSeconds) * 100;
      progressBar.style.width = progress + "%";
    }

    function startCountdown() {
      stopCountdown();

      timerInterval = setInterval(() => {
        if (shouldTriggerCheckpoint()) {
          pauseCountdownForHold();
          return;
        }

        remaining--;
        updateTimerUI();

        if (remaining <= 0) {
          stopCountdown();
          window.location.href = SUPPORT_LINK;
        }
      }, 1000);
    }

    function stopCountdown() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function shouldTriggerCheckpoint() {
      if (nextCheckpointIndex >= checkpoints.length) return false;
      return remaining === checkpoints[nextCheckpointIndex];
    }

    function pauseCountdownForHold() {
      stopCountdown();
      nextCheckpointIndex++;
      showRandomHoldOverlay();
    }

    function showRandomHoldOverlay() {
      const holdOverlay = document.getElementById("holdOverlay");
      const holdBar = document.getElementById("holdBar");
      const holdBtn = document.getElementById("holdBtn");
      const holdMessage = document.getElementById("holdMessage");

      const messages = [
        "Hold the button for <b>3 seconds</b> to continue.",
        "Security check: hold for <b>3 seconds</b>.",
        "Almost done. Press & hold for <b>3 seconds</b>.",
        "Quick verify: hold the button for <b>3 seconds</b>."
      ];
      holdMessage.innerHTML = messages[Math.floor(Math.random() * messages.length)];

      holdBar.style.width = "0%";
      holdOverlay.style.display = "flex";

      // Rebind hold button
      const freshBtn = holdBtn.cloneNode(true);
      holdBtn.parentNode.replaceChild(freshBtn, holdBtn);

      const requiredHoldMs = 3000;
      const tickMs = 20;
      const steps = requiredHoldMs / tickMs;

      let holding = false;
      let holdProgress = 0;
      let holdInterval = null;

      function resetHold() {
        holding = false;
        holdProgress = 0;
        holdBar.style.width = "0%";
        if (holdInterval) clearInterval(holdInterval);
        holdInterval = null;
      }

      function startHold() {
        if (holding) return;
        holding = true;

        holdInterval = setInterval(() => {
          holdProgress++;
          const percent = Math.min((holdProgress / steps) * 100, 100);
          holdBar.style.width = percent + "%";

          if (percent >= 100) {
            clearInterval(holdInterval);
            holdInterval = null;

            holdOverlay.style.display = "none";
            resetHold();
            startCountdown();
          }
        }, tickMs);
      }

      function stopHold() {
        if (!holding) return;
        resetHold();
      }

      freshBtn.addEventListener("mousedown", (e) => { e.preventDefault(); startHold(); });
      freshBtn.addEventListener("mouseup", stopHold);
      freshBtn.addEventListener("mouseleave", stopHold);

      freshBtn.addEventListener("touchstart", (e) => { e.preventDefault(); startHold(); }, { passive: false });
      freshBtn.addEventListener("touchend", stopHold);
      freshBtn.addEventListener("touchcancel", stopHold);

      resetHold();
    }
  </script>
</body>
</html>
